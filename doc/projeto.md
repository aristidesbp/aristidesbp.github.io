ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
# PERSONA: ARISTIDES (MENTOR)
ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥

* Perfil do Mentor: Engenheiro de Software SÃªnior e Professor de ComputaÃ§Ã£o focado em alta performance e concursos de TI. Seu objetivo Ã© guiar o desenvolvimento do projeto "ERP ABP" utilizando o padrÃ£o "PadrÃ£o Ouro" de mercado.
  
**DIRETRIZES DE RESPOSTA**:
* Metodologia PrÃ¡tica: NÃ£o entregua apenas cÃ³digos isolados; explica onde o cÃ³digo se encaixa na arquitetura MVC (Model-View-Controller).
* Rigor TÃ©cnico: Trata o projeto como um sistema real de alto valor comercial (R$ 10k+). Usando boas prÃ¡ticas de Engenharia de Software: PrincÃ­pios SOLID, DRY (Don't Repeat Yourself) e Clean Code.

**CICLO DE DESENVOLVIMENTO**: 
* Guia o projeto por fases: DocumentaÃ§Ã£o e Requisitos -> Modelagem de Dados (MER/DER) -> Arquitetura de Pastas -> Desenvolvimento Modular -> IntegraÃ§Ãµes (APIs/AutomaÃ§Ãµes) -> Testes e Deploy.
* Modernidade: Sempre sugeri integraÃ§Ãµes inteligentes (Webhooks, APIs de pagamento, AutomaÃ§Ãµes com IA, Supabase para Backend as a Service) e tendÃªncias de UI/UX que valorizem o produto final.
* Linguagem: Usa Markdown para clareza e LaTeX apenas para fÃ³rmulas matemÃ¡ticas complexas. Priorize a organizaÃ§Ã£o visual que permita consulta rÃ¡pida.

ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
## Checklist de Engenharia 
ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
* No padrÃ£o "ABP", seguimos o fluxo: Interface -> Infraestrutura -> LÃ³gica -> Dados
**Porque seguir esse padrao?**
* Voce tera um esborso do projeto para feichar o contrato (as paginas estaticas podem ser criadas em minutos por IAs).
* Tera uma visao geral de tudo que precisa e usarÃ¡ futuramente para repassar esta ideia para outras IAs.
* Estamos no ano de 2026 e a briga entre as IAs esta aquecida nos dando diversas ferramentas para desenvolver de forma gratuitas sem programar.
 
**Exemplo de Roteiro**:
* Desenvolvedor/Gemini -> (cria estrutura do projeto e os prompts)
* Google stittch -> (Criar interface)
* Google IA studio -> (Colocar id e navegaÃ§Ã£o) 
* Google antigravity -> (conectar com supabase )

ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
# ğŸ† Checklist de Engenharia: Metodologia ABP (Agile Blueprint)
ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
## 1. ğŸ¨ FASE: Interface & ExperiÃªncia (UI/UX)
* Ferramenta: Google Stitch / v0.dev / Bolt.new
* Objetivo: Criar o impacto visual imediato para fechar o contrato.
* AÃ§Ã£o: Gerar pÃ¡ginas estÃ¡ticas com nomes de IDs semÃ¢nticos (ex: btn_finalizar_venda).
* Verificar se IDs semanticos foram criados, caso contraio faÃ§a.
* Por que primeiro? Prova de conceito visual. O cliente "toca" no produto antes dele existir.

## 2. ğŸ—„ï¸ FASE: Estrutura de Dados (Data Schema)
* Ferramenta: Supabase (PostgreSQL) / Claude Artifacts
* Objetivo: Definir a "memÃ³ria" do sistema.
* AÃ§Ã£o: Criar as tabelas no Supabase com base nos campos que a Interface pediu.
* Por que agora? NÃ£o se constrÃ³i uma casa sem saber onde canos e fiaÃ§Ã£o (dados) vÃ£o passar. Sem o banco, a lÃ³gica nÃ£o tem onde salvar.

## 3. ğŸ§  FASE: LÃ³gica de NegÃ³cio & Conectividade (Controller)
* Criar estrutura de pastas MVC. (documentaÃ§Ã£o para IA poder criar codigos genericos)
* Ferramenta: Google AI Studio / Gemini 1.5 Pro
* Objetivo: Dar vida aos botÃµes.
* AÃ§Ã£o: Criar as funÃ§Ãµes async/await que pegam os dados da Interface e enviam para o Supabase. Ã‰ o padrÃ£o MVC em aÃ§Ã£o.
* Por que aqui? Agora que temos a Interface (origem) e o Banco (destino), a IA consegue escrever o cÃ³digo de conexÃ£o sem erros.

## 4. ğŸ›°ï¸ FASE: Infraestrutura & AutomaÃ§Ã£o (Antigravity/APIs)
*  Ferramenta: Google Antigravity / Make.com / APIs de Pagamento
*  Objetivo: Tornar o sistema "inteligente" e escalÃ¡vel.
*  AÃ§Ã£o: Conectar Webhooks, Gateway de Pagamento (Mercado Pago) e disparos de WhatsApp/E-mail.
*  Por que por Ãºltimo? SÃ£o os "acessÃ³rios de luxo". VocÃª sÃ³ instala o ar-condicionado (API) depois que as paredes (LÃ³gica/Dados) estÃ£o prontas.

## ğŸ§ Por que esta ordem Ã© superior?
* Valor Comercial: O cliente vÃª o projeto pronto em minutos (Fase 1).
* SeguranÃ§a TÃ©cnica: O banco de dados (Fase 2) garante que a lÃ³gica (Fase 3) nÃ£o falhe por falta de colunas ou tipos de dados errados.
* Escalabilidade: Deixamos as integraÃ§Ãµes pesadas para o final, quando o nÃºcleo do ERP jÃ¡ estÃ¡ estÃ¡vel.   


## 1. Requisitos e Regras de NegÃ³cio (O Contrato)
Um sistema de 10k nÃ£o comeÃ§a no teclado, comeÃ§a no papel. Em concursos, isso cai como Engenharia de Requisitos.
* **RF001**: O sistema deve realizar uma venda garantindo a atomicidade. Ou seja, ou salva tudo (venda, itens, financeiro e baixa de estoque) ou nÃ£o salva nada.
* **ACID** (Atomicidade, ConsistÃªncia, Isolamento e Durabilidade): Se o banco de dados falhar no meio do processo e vocÃª jÃ¡ tiver dado baixa no estoque mas nÃ£o salvou o financeiro, seu sistema Ã© lixo.

ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
## 1. ğŸ¨ FASE: Interface & ExperiÃªncia (UI/UX)
ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥


            
ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
# Estrutura do projeto MVC+Service (Model-View-Controller)
ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
```
ERP-ABP/
â”œâ”€â”€ ğŸ“‚ coc/                 # DocumentaÃ§Ã£o do projeto
â”œâ”€â”€ ğŸ“‚ assets/              # Imagens, logos e Ã­cones
â”œâ”€â”€ ğŸ“‚ css/                 # Estilos (Global e especÃ­ficos)
â”‚   â”œâ”€â”€ main.css
â”‚   â””â”€â”€ navbar.css
â”‚ 
â”œâ”€â”€ ğŸ“‚ src/                  # CÃ³digo-fonte principal (MVC)
â”‚   â”œâ”€â”€ ğŸ“‚ model/            # Camada de Dados e Regras de NegÃ³cio
â”‚   â”‚   â”œâ”€â”€ Database.js      # ConfiguraÃ§Ã£o Supabase
â”‚   â”‚   â”œâ”€â”€ EstoqueModel.js  # Regras de baixa e validaÃ§Ã£o
â”‚   â”‚   â””â”€â”€ VendaModel.js    # Regras de cÃ¡lculo e descontos
â”‚   â”‚ 
â”‚   â”œâ”€â”€ ğŸ“‚ view/             # Camada de Interface (DOM)
â”‚   â”‚   â”œâ”€â”€ navbar.js        # Renderiza menu de navegaÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ tema.js          # botao tema  claro ou escruo
â”‚   â”‚   â””â”€â”€ logalt.js        # botao para sair (modais, loaders)
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ controller/                # Camada de Controle (O "Maestro")
â”‚       â”œâ”€â”€ AuthController.js
â”‚       â”œâ”€â”€ criar_variaveis_id.js
â”‚       â”œâ”€â”€ validar_acesso.js
â”‚       â””â”€â”€ FinanceiroController.js
â”‚ 
â”œâ”€â”€ ğŸ“‚ services/               # ServiÃ§os de terceiros e APIs
â”‚   â”œâ”€â”€ Mercado_pago.js        # Metodo de pagamento APIS (IntegraÃ§Ã£o)
â”‚   â”œâ”€â”€ SupabaseService.js     # AbstraÃ§Ã£o do banco (Select/Insert)
â”‚   â””â”€â”€ PrintService.js        # LÃ³gica de geraÃ§Ã£o de PDF (jsPDF)
â”‚
â”œâ”€â”€ ğŸ“‚ utils/               # FunÃ§Ãµes auxiliares (Globais)
â”‚   â”œâ”€â”€ Formatador.js       # Datas e Moeda (R$)
â”‚   â””â”€â”€ Validadores.js      # CPF/CNPJ e Senhas
â”‚
â”œâ”€â”€ entidades.html
â”œâ”€â”€ financeiro.html
â”œâ”€â”€ produtos.html
â”œâ”€â”€ pdv.html
â”œâ”€â”€ loja_virtual.html
â”œâ”€â”€ tarefas.html
â”œâ”€â”€ configuracoes.html
â”œâ”€â”€ vendas.html
â”œâ”€â”€ index.html              # Dashboard Principal
â””â”€â”€ login.html              # Tela de Acesso
```

# Por que isso Ã© importante para um "sistema de 10k"?
* OrganizaÃ§Ã£o: Se vocÃª quiser mudar o design (View), nÃ£o precisa mexer na lÃ³gica de cÃ¡lculo (Model).
* Escalabilidade: Permite que vÃ¡rios desenvolvedores trabalhem simultaneamente: um cuida do banco de dados enquanto outro cuida da interface.
* Reuso: VocÃª pode usar o mesmo Model (lÃ³gica de produtos) para o PDV e para um futuro aplicativo de estoque.

# ğŸ§  Por que esta estrutura Ã© perfeita para concursos?
Se um avaliador olhar esse projeto, ele identificarÃ¡ os seguintes princÃ­pios de engenharia:
* **SRP** (PrincÃ­pio de Responsabilidade Ãšnica): Cada arquivo faz apenas uma coisa. O arquivo que calcula o preÃ§o nÃ£o Ã© o mesmo que desenha o botÃ£o na tela.
* **SoC** (SeparaÃ§Ã£o de PreocupaÃ§Ãµes): Se vocÃª decidir trocar o Supabase pelo Firebase, vocÃª sÃ³ mexe na pasta SERVICES, o resto do sistema nem percebe a mudanÃ§a.
* **DRY** (Don't Repeat Yourself): FunÃ§Ãµes como formatar "R$ 10,00" ficam em utils e sÃ£o usadas em todo o sistema, evitando repetiÃ§Ã£o de cÃ³digo.
* **Escalabilidade**: Esse projeto pode comeÃ§ar com 10 arquivos e chegar a 1.000 sem virar uma "bagunÃ§a de espaguete".

# src/model (modelo/db)
* Ã‰ o cÃ©rebro do sistema, ele gerencia os dados, a lÃ³gica de negÃ³cio e as regras de armazenamento. O Model Ã© representado pelas tabelas do Supabase (produtos, vendas, financeiro, tarefas) e pelas funÃ§Ãµes que manipulam esses dados antes de salvÃ¡-los.
* Exemplo: A regra que impede a venda de um produto se o estoque_atual for menor que a quantidade desejada.

# src/view (js para construir a pagina, nÃ£o interage com model)
* Ã‰ a interface com a qual o usuÃ¡rio interage (o que ele vÃª na tela).
* Exemplo: O grid de produtos, o visor do carrinho e o botÃ£o "FINALIZAR (F2)".

# src/Controller 
* Pega os dados da view, trata e manda pro model.
* pega os dados do model, e manda para view.
* Ã‰ o intermediÃ¡rio entre o Model e a View. Ele recebe as entradas do usuÃ¡rio (cliques, digitaÃ§Ã£o), processa o pedido atravÃ©s do Model e atualiza a View com o resultado.
* Exemplo: Quando o usuÃ¡rio clica em "adicionar ao carrinho", o Controller busca os dados no Model, faz o cÃ¡lculo e manda a View atualizar o subtotal na tela.



## ğŸ Fase 1: O Alicerce (Infra e ConfiguraÃ§Ã£o)
```
[ ] ConfiguraÃ§Ã£o Supabase: Criar o projeto no Dashboard e obter URL e ANON_KEY.
[ ] src/model/Database.js: Centralizar as variÃ¡veis de ambiente e inicializar o client do Supabase.
[ ] services/SupabaseService.js: Criar as funÃ§Ãµes genÃ©ricas de CRUD (insert, select, update, delete). Isso evita que vocÃª repita cÃ³digo do SDK em todo arquivo.
[ ] utils/Formatador.js: Criar a funÃ§Ã£o de formataÃ§Ã£o de moeda e data. VocÃª usarÃ¡ isso do Dashboard ao PDV.
```
## ğŸ“Š Fase 2: Modelagem e PersistÃªncia (Back-end Mindset)
```
Aqui definimos as regras do jogo. O banco de dados Ã© a Ãºnica fonte da verdade.
[ ] SQL/MigraÃ§Ãµes: Executar o script SQL no Supabase para criar as tabelas (produtos, vendas, itens_venda, financeiro).
[ ] src/model/EstoqueModel.js: Implementar a lÃ³gica de "Baixa de Estoque".
Regra: Se estoque_atual < pedido, retorne erro.
[ ] src/model/VendaModel.js: LÃ³gica de cÃ¡lculo (Subtotal, Descontos, Impostos).
```
## âš™ï¸ Fase 3: O CÃ©rebro (Controller)
```
O Controller liga os serviÃ§os ao modelo. Ã‰ aqui que o sistema "ganha vida".
[ ] controller/AuthController.js: Validar login e persistir a sessÃ£o no localStorage.
[ ] controller/validar_acesso.js: Middleware que verifica em cada pÃ¡gina .html se o usuÃ¡rio estÃ¡ logado. Se nÃ£o, redireciona para login.html.
[ ] controller/FinanceiroController.js: Integrar a conclusÃ£o de uma venda com a criaÃ§Ã£o automÃ¡tica de uma "Conta a Receber".
```
## ğŸš€ Fase 4: IntegraÃ§Ãµes e Polish (Valor Agregado)
```
O que transforma um CRUD bÃ¡sico em um produto de alto valor.
[ ] services/PrintService.js: Gerar o PDF do comprovante de venda usando jsPDF.
[ ] services/Mercado_pago.js: Gerar o QR Code de pagamento via API.
[ ] Dashboard (index.html): GrÃ¡ficos simples consumindo dados do FinanceiroController.
```
## ğŸ¨ Fase 5: A Fachada (View & UI)
```
Agora, e somente agora, focamos no que o usuÃ¡rio toca.
[ ] src/view/navbar.js: Componentizar o menu para que ele seja injetado em todas as pÃ¡ginas (evita ter que alterar 10 HTMLs quando criar um menu novo).
[ ] src/view/tema.js: PersistÃªncia do Dark/Light mode no localStorage.
[ ] IntegraÃ§Ã£o do PDV (pdv.html): Conectar os inputs da tela com o VendaController.js.
```


ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
# ğŸ Fase 0: O Alicerce (Infra e ConfiguraÃ§Ã£o)
ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
## ConfiguraÃ§Ã£o Supabase: Criar o projeto no Dashboard e obter URL e ANON_KEY.

## ğŸŸ¥ src/model/Database.js: 
```
/**
 * src/model/Database.js
 * PadrÃ£o: Singleton
 * Responsabilidade: Gerenciar a conexÃ£o Ãºnica com o provedor de dados (Supabase).
 */

class Database {
    constructor() {
        if (!Database.instance) {
            this.client = window.supabaseClient; // JÃ¡ inicializado no supabase_config.js
            Database.instance = this;
        }
        return Database.instance;
    }

    getConnection() {
        if (!this.client) {
            throw new Error("ConexÃ£o com o banco de dados nÃ£o inicializada.");
        }
        return this.client;
    }
}

const instance = new Database();
export default instance;
```
* Centralizar as variÃ¡veis de ambiente e inicializar o client do Supabase.
* CÃ³digo Sugerido (PadrÃ£o Enterprise):
* A camada **src/model/Database.js**: Este arquivo nÃ£o deve apenas conter a chave do Supabase. Ele deve ser o **Singleton** (padrÃ£o de projeto) que garante que teremos apenas uma instÃ¢ncia de conexÃ£o com o banco, economizando memÃ³ria e recursos.

## Vamos Ã  autÃ³psia tÃ©cnica do cÃ³digo:
** AnÃ¡lise Linha por Linha**:

``` class Database {```
* O que Ã©: DefiniÃ§Ã£o de uma Classe em JavaScript (ES6).
* VisÃ£o de Mentor: No padrÃ£o MVC, o Model comeÃ§a aqui. Usamos classes para encapsular lÃ³gica e proteger os dados.

```constructor() {```
* O que Ã©: O mÃ©todo especial que Ã© executado toda vez que vocÃª dÃ¡ um new Database().
  
```if (!Database.instance) {```
* O que Ã©: Aqui comeÃ§a a implementaÃ§Ã£o do PadrÃ£o **Singleton**. Verificamos se "jÃ¡ existe uma cÃ³pia dessa classe viva na memÃ³ria".
* Foco em Concurso: O Singleton Ã© um padrÃ£o Creational (de criaÃ§Ã£o). Ele garante que uma classe tenha apenas uma Ãºnica instÃ¢ncia em todo o ciclo de vida da aplicaÃ§Ã£o.
  
```this.client = window.supabaseClient;```
* O que Ã©: AtribuÃ­mos a conexÃ£o do Supabase (que **veio do seu arquivo supabase_config.js**) a uma propriedade interna da classe.
* VisÃ£o de Mentor: Note que usamos o **window.supabaseClient**. Em um sistema profissional, isso evita que vocÃª crie vÃ¡rias conexÃµes simultÃ¢neas, o que poderia derrubar seu limite de acessos no banco de dados.
  
```Database.instance = this;```
* O que Ã©: Guardamos a instÃ¢ncia atual dentro da prÃ³pria classe. Ã‰ como se a classe dissesse: "Eu jÃ¡ existo, estou salva aqui".
  
```return Database.instance;```
* O que Ã©: Se alguÃ©m tentar criar um new Database() de novo, o construtor ignora a criaÃ§Ã£o e devolve aquela que jÃ¡ estava pronta.
  
```getConnection() {```
* O que Ã©: Um mÃ©todo "Getter". Ã‰ a porta de entrada para usar o banco.
* Rigor TÃ©cnico: O Controller nunca deve tocar no this.client diretamente; ele deve pedir licenÃ§a ao getConnection.
  
```if (!this.client) { throw new Error("..."); }```
* O que Ã©: Tratamento de erros (Fail-fast). Se por algum motivo a internet cair ou a chave do Supabase falhar, o sistema para aqui com uma mensagem clara, em vez de travar o navegador do cliente.
  
```const instance = new Database();```
* O que Ã©: Criamos a instÃ¢ncia Ãºnica.
  
```export default instance;```
* O que Ã©: Exportamos o objeto jÃ¡ pronto.
* PadrÃ£o Enterprise: Quem importar esse arquivo (o seu SupabaseService) jÃ¡ recebe a conexÃ£o aberta e pronta para o combate.
* ğŸ§  Por que isso cai em concursos de TI? Se vocÃª estiver fazendo uma prova da FGV ou CESPE, eles podem perguntar sobre Design Patterns.
* QuestÃ£o TeÃ³rica: "Qual padrÃ£o de projeto Ã© indicado para gerenciar conexÃµes com recursos escassos, como bancos de dados ou logs, garantindo um Ãºnico ponto de acesso global?" Resposta: Singleton.
  
**ğŸ’¡ A DiferenÃ§a entre o Programador de R$ 2k e o de R$ 10k**
* O de 2k: Copia e cola o cÃ³digo de conexÃ£o em cada pÃ¡gina HTML. Se a senha do banco mudar, ele tem que abrir 20 arquivos para consertar.
* O de 10k (VocÃª): Centraliza tudo no Database.js. Se mudar o banco para Firebase, PostgreSQL ou Oracle, vocÃª altera apenas um lugar. Isso se chama Manutenibilidade.

## ğŸŸ¥ services/SupabaseService.js: Criar as funÃ§Ãµes genÃ©ricas de CRUD (insert, select, update, delete). Isso evita que vocÃª repita cÃ³digo do SDK em todo arquivo.
* A Camada Service: O "GarÃ§om" do Sistema:

## Criando o services/SupabaseService.js
```
import db from '../src/model/Database.js';

export const SupabaseService = {
    /**
     * Busca todos os registros de uma tabela com filtro opcional.
     * @param {string} tabela 
     * @param {object} filtros 
     */
    async buscarTodos(tabela, colunaFiltro = 'id', valorFiltro = null) {
        let query = db.getConnection().from(tabela).select('*');
        
        if (valorFiltro) {
            query = query.eq(colunaFiltro, valorFiltro);
        }

        const { data, error } = await query;
        if (error) throw new Error(`Erro ao buscar em ${tabela}: ${error.message}`);
        return data;
    },

    async inserir(tabela, dados) {
        const { data, error } = await db.getConnection().from(tabela).insert(dados).select();
        if (error) throw new Error(`Erro ao inserir em ${tabela}: ${error.message}`);
        return data;
    }
};

```

## Por que usamos a pasta services/? 
* No MVC puro, o Controller fala com o Model. Mas em sistemas modernos (SaaS), usamos Services para isolar as chamadas de API. Se amanhÃ£ vocÃª sair do Supabase e for para o PostgreSQL puro, seu Controller nÃ£o muda 1 linha de cÃ³digo. Isso Ã© o **PrincÃ­pio da InversÃ£o de DependÃªncia** (D de SOLID).
* Se o Database.js Ã© o coraÃ§Ã£o que bombeia a conexÃ£o, o SupabaseService.js sÃ£o as artÃ©rias. Na engenharia de software, chamamos isso de Camada de ServiÃ§o (Service Layer) ou Data Access Object (DAO).

#### Este cÃ³digo Ã© o que separa um sistema amador de um sistema de R$ 10k. Vamos Ã  anÃ¡lise tÃ©cnica:(AnÃ¡lise Linha por Linha)

``` import db from '../src/model/Database.js';```
* O que faz: Importa a instÃ¢ncia Ãºnica (Singleton) que criamos anteriormente.
* Rigor TÃ©cnico: Note que nÃ£o importamos o Supabase diretamente aqui. Importamos o nosso "Gerenciador". Isso garante que o Service use a conexÃ£o oficial e protegida do sistema.
* 
```export const SupabaseService = {```
* O que faz: Exporta um objeto literal contendo mÃ©todos reutilizÃ¡veis.
* VisÃ£o de Mentor: Em vez de escrever o cÃ³digo do Supabase em cada pÃ¡gina (PDV, Estoque, Clientes), vocÃª centraliza aqui. Se o Supabase atualizar a versÃ£o da biblioteca deles, vocÃª sÃ³ conserta neste arquivo.
* 
```async buscarTodos(tabela, colunaFiltro = 'id', valorFiltro = null) {```
* O que faz: Uma funÃ§Ã£o assÃ­ncrona genÃ©rica para buscar dados.
**ParÃ¢metros**:
* tabela: Qual tabela queremos (ex: 'produtos').
* colunaFiltro: Qual coluna testar (padrÃ£o Ã© 'id').
* valorFiltro: O valor que buscamos. Se for null, ele traz tudo.
*Foco em Concurso: Isso demonstra AbstraÃ§Ã£o. O Controller nÃ£o precisa saber "como" o banco busca, apenas pede os dados.

```let query = db.getConnection().from(tabela).select('*');```
* O que faz: Prepara a "pergunta" (query) para o banco de dados.
* Linha CrÃ­tica: db.getConnection() chama aquele mÃ©todo que explicamos antes, garantindo que a conexÃ£o exista.

```if (valorFiltro) { query = query.eq(colunaFiltro, valorFiltro); }```
* O que faz: Se vocÃª passou um filtro (ex: buscar apenas o produto com cÃ³digo '123'), ele adiciona a clÃ¡usula .eq (equal/igual). Se nÃ£o passou, a query continua configurada para trazer todos os registros.

```const { data, error } = await query;```
* O que faz: Executa a busca de fato e espera (await) o servidor responder.
* Rigor TÃ©cnico: O Supabase sempre retorna um objeto com data (sucesso) ou error (falha).

```if (error) throw new Error(...);```
* O que faz: Tratamento de ExceÃ§Ã£o. Se o banco estiver fora do ar ou a tabela nÃ£o existir, o cÃ³digo "lanÃ§a" um erro.
* VisÃ£o de Mentor: Um sistema de 10k nunca esconde erros. Ele os trata para que o desenvolvedor saiba exatamente o que falhou.

```async inserir(tabela, dados) { ... }```
* O que faz: MÃ©todo genÃ©rico para salvar qualquer coisa (Vendas, Clientes, Tarefas).
* .insert(dados).select(): Insere os dados e pede para o banco retornar o registro que acabou de ser criado (Ãºtil para pegar o ID gerado automaticamente).
* ğŸ§  Por que isso Ã© "PadrÃ£o Ouro" (VisÃ£o de Concurso)? Em provas de Desenvolvimento de Sistemas, costuma-se cobrar o conceito de Desacoplamento.

**Observe a hierarquia**:
*  View (HTML): NÃ£o sabe que o banco existe.
*  Controller: Sabe que precisa de dados, mas nÃ£o sabe "como" pegar. Ele chama o Service.
*  Service: Sabe "como" falar com o Supabase.
*  Database (Singleton): Sabe "onde" estÃ¡ a chave e a URL de conexÃ£o.

Vantagem Comercial: Se vocÃª quiser vender esse ERP para uma empresa que nÃ£o usa nuvem e prefere um banco de dados local (MySQL), vocÃª sÃ³ precisaria reescrever este arquivo SupabaseService.js. Todo o resto do seu sistema (PDV, Financeiro, etc.) continuaria funcionando sem mudar uma vÃ­rgula.




## ğŸŸ¥ utils/Formatador.js: Criar a funÃ§Ã£o de formataÃ§Ã£o de moeda e data. VocÃª usarÃ¡ isso do Dashboard ao PDV.


ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥
# 2. Modelagem de Dados (MER/DER)
ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥ğŸŸ¥

## ğŸŸ¥ TABELA COMPLETA:
```
-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.entidades (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid DEFAULT auth.uid(),
  nome_completo text NOT NULL,
  cpf text,
  data_nascimento date,
  genero text,
  estado_civil text,
  tipo_entidade text,
  status_entidade text,
  tipo_acesso text,
  email text,
  telefone text,
  senha_acesso text,
  cep text,
  logradouro text,
  numero text,
  bairro text,
  cidade text,
  estado text,
  avaliacao integer DEFAULT 5,
  observacoes text,
  arquivos_url ARRAY,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT entidades_pkey PRIMARY KEY (id),
  CONSTRAINT entidades_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.financeiro (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid DEFAULT auth.uid(),
  entidade_id uuid,
  tipo text CHECK (tipo = ANY (ARRAY['Pagar'::text, 'Receber'::text, 'pagar'::text, 'receber'::text])),
  descricao text NOT NULL,
  categoria text,
  forma_pagamento text,
  data_vencimento date,
  data_pagamento date,
  valor numeric DEFAULT 0,
  status text CHECK (status = ANY (ARRAY['Pendente'::text, 'Pago'::text, 'pendente'::text, 'pago'::text])),
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT financeiro_pkey PRIMARY KEY (id),
  CONSTRAINT financeiro_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT financeiro_entidade_id_fkey FOREIGN KEY (entidade_id) REFERENCES public.entidades(id)
);
CREATE TABLE public.notes (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid DEFAULT auth.uid(),
  title text NOT NULL,
  content text,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT notes_pkey PRIMARY KEY (id),
  CONSTRAINT notes_user_id_fkey1 FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.pedidos (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  cliente_nome text,
  total numeric,
  status text DEFAULT 'pendente'::text,
  itens jsonb,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT pedidos_pkey PRIMARY KEY (id)
);
CREATE TABLE public.produtos (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid DEFAULT auth.uid(),
  nome text NOT NULL,
  codigo_de_barras text,
  marca text,
  sku text,
  categoria_prod text,
  entidade_id uuid,
  descricao text,
  data_vencimento date,
  preco_custo numeric DEFAULT 0,
  preco_venda numeric DEFAULT 0,
  estoque_atual integer DEFAULT 0,
  estoque_minimo integer DEFAULT 5,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  data_compra date,
  imagem_url text,
  CONSTRAINT produtos_pkey PRIMARY KEY (id),
  CONSTRAINT produtos_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT produtos_entidade_id_fkey FOREIGN KEY (entidade_id) REFERENCES public.entidades(id)
);
CREATE TABLE public.tarefas (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid DEFAULT auth.uid(),
  title text NOT NULL,
  content text,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  entidade text,
  tarefa_descricao text,
  status text DEFAULT 'pendente'::text,
  observacao text,
  CONSTRAINT tarefas_pkey PRIMARY KEY (id),
  CONSTRAINT notes_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.venda_itens (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  venda_id uuid,
  produto_id uuid,
  quantidade integer NOT NULL,
  preco_unitario numeric NOT NULL,
  CONSTRAINT venda_itens_pkey PRIMARY KEY (id),
  CONSTRAINT venda_itens_produto_id_fkey FOREIGN KEY (produto_id) REFERENCES public.produtos(id),
  CONSTRAINT venda_itens_venda_id_fkey FOREIGN KEY (venda_id) REFERENCES public.vendas(id)
);
CREATE TABLE public.vendas (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid DEFAULT auth.uid(),
  entidade_id uuid,
  total_venda numeric NOT NULL,
  metodo_pagamento text,
  data_venda timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT vendas_pkey PRIMARY KEY (id),
  CONSTRAINT vendas_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT vendas_entidade_id_fkey FOREIGN KEY (entidade_id) REFERENCES public.entidades(id)
);
```
## ğŸŸ¥ CRIAR APOLICIES
```
-- 2. Habilitar o Row Level Security (SeguranÃ§a de Linha)
ALTER TABLE notes ENABLE ROW LEVEL SECURITY;

-- 3. Criar polÃ­tica: UsuÃ¡rios podem ver apenas suas prÃ³prias notas
CREATE POLICY "UsuÃ¡rios podem ver suas prÃ³prias notas" 
ON notes FOR SELECT 
USING (auth.uid() = user_id);

-- 4. Criar polÃ­tica: UsuÃ¡rios podem inserir apenas suas prÃ³prias notas
CREATE POLICY "UsuÃ¡rios podem inserir suas prÃ³prias notas" 
ON notes FOR INSERT 
WITH CHECK (auth.uid() = user_id);

-- 5. Criar polÃ­tica: UsuÃ¡rios podem atualizar apenas suas prÃ³prias notas
CREATE POLICY "UsuÃ¡rios podem atualizar suas prÃ³prias notas" 
ON notes FOR UPDATE 
USING (auth.uid() = user_id);

-- 6. Criar polÃ­tica: UsuÃ¡rios podem deletar apenas suas prÃ³prias notas
CREATE POLICY "UsuÃ¡rios podem deletar suas prÃ³prias notas" 
ON notes FOR DELETE 
USING (auth.uid() = user_id);
```



























