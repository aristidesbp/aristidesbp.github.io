<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Buscar Campos da Tabela - Supabase</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- SUPABASE CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f1f5f9;
    padding: 40px;
}

.box {
    max-width: 520px;
    margin: auto;
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

h2 {
    margin-top: 0;
    color: #0f172a;
}

select, button {
    width: 100%;
    padding: 12px;
    margin-top: 12px;
    font-size: 14px;
}

button {
    background: #3ecf8e;
    color: white;
    border: none;
    cursor: pointer;
    font-weight: bold;
}

button:hover {
    opacity: 0.9;
}

ul {
    margin-top: 20px;
    padding-left: 20px;
}

li {
    margin-bottom: 6px;
}

.error {
    color: red;
    margin-top: 15px;
}
</style>
</head>

<body>

<div class="box">
    <h2>Buscar Campos da Tabela</h2>

    <label>Selecione a tabela</label>
    <select id="tabela">
        <option value="">-- escolha --</option>
        <option value="entidades">entidades</option>
        <option value="usuarios">usuarios</option>
        <option value="produtos">produtos</option>
        <option value="financeiro">financeiro</option>
        <option value="vendas">vendas</option>
        <option value="vendas_itens">vendas_itens</option>
        <option value="controle_caixa">controle_caixa</option>
        <option value="notes">notes</option>
    </select>

    <button onclick="buscar()">Buscar Campos</button>

    <ul id="resultado"></ul>
    <div id="erro" class="error"></div>
</div>

<script>
// ===============================
// CONFIGURAÇÃO SUPABASE
// ===============================
const SUPABASE_URL = 'https://kjhjeaiwjilkgocwvbwi.supabase.co'
const SUPABASE_KEY = 'sb_publishable_WP3TF2GTMMWCS1tCYzQSjA_syIKLyIX'
const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY)

// ===============================
// FUNÇÃO PRINCIPAL
// ===============================
async function buscar() {
    const tabela = document.getElementById('tabela').value
    const resultado = document.getElementById('resultado')
    const erro = document.getElementById('erro')

    resultado.innerHTML = ''
    erro.innerText = ''

    if (!tabela) {
        erro.innerText = 'Selecione uma tabela.'
        return
    }

    try {
        const { data, error } = await supabaseClient
            .from(tabela)
            .select('*')
            .limit(1)

        if (error) throw error

        if (!data || data.length === 0) {
            erro.innerText = 'Tabela vazia. Não é possível identificar campos.'
            return
        }

        const campos = Object.keys(data[0])

        campos.forEach(campo => {
            const li = document.createElement('li')
            li.textContent = campo
            resultado.appendChild(li)
        })

    } catch (err) {
        erro.innerText = 'Erro: ' + err.message
        console.error(err)
    }
}
</script>

</body>
</html>
